generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlserver"
  url      = env("DB_URL")
}

// Модель для таблицы сотрудников из SQL Server
// 
// ВАЖНО: Имя таблицы определяется автоматически при первом обращении к БД
// Функция detectTableName() в src/db.js сканирует все таблицы в базе данных
// и находит первую таблицу, которая содержит все обязательные колонки:
//   - VCode (Int, Primary Key)
//   - Фамилия, Имя, Отчество (nvarchar)
//   - Подразделение, Должность (Int)
//   - Сотовый (nvarchar)
//   - ДатаУвольнения (datetime, nullable)
// 
// Опциональные колонки (желательные, но не обязательные):
//   - ТелеграмID (bigint, nullable)
//   - ТелеграмЮзернейм (nvarchar, nullable)
//   - ЧерныйСписок (bit, nullable)
//
// @@map ниже используется только как fallback и не влияет на работу бота,
// т.к. все запросы выполняются через raw SQL с динамически найденным именем таблицы
model LexemaCard {
  code              Int       @id @map("VCode") // VCode - код сотрудника (обязательно)
  lastName          String?   @map("Фамилия") // Фамилия (обязательно)
  firstName         String?   @map("Имя") // Имя (обязательно)
  middleName        String?   @map("Отчество") // Отчество (обязательно)
  departmentId      Int?      @map("Подразделение") // Подразделение - ID отдела (обязательно)
  positionId        Int?      @map("Должность") // Должность - ID должности (обязательно)
  terminationDate   DateTime? @map("ДатаУвольнения") // ДатаУвольнения - дата увольнения, NULL = работает (обязательно)
  phone             String?   @map("Сотовый") // Сотовый - номер телефона (обязательно)
  telegramUsername  String?   @map("ТелеграмЮзернейм") // ТелеграмЮзернейм - username в Telegram (опционально)
  telegramId        BigInt?   @map("ТелеграмID") // ТелеграмID - ID пользователя в Telegram (опционально)
  blacklisted       Boolean?  @default(false) @map("ЧерныйСписок") @db.Bit // ЧерныйСписок - флаг черного списка (опционально)

  // Fallback имя таблицы (не используется, т.к. имя определяется автоматически)
  // @@map("Lexema_Кадры_ЛичнаяКарточка")
}


