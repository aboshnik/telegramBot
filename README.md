
Функции
- Принимает ФИО, должность, отдел одной строкой (или через `|`) и сверяет со справочником `employees_ref`.
- Генерирует/переиспользует персональную инвайт-ссылку в канал отдела с TTL.
- Привязка сотрудников к Telegram ID/username в базе.
- Отдельная meta-БД для каналов отделов и списка админов.
- Логирование действий админов (удаления, ошибки) в meta-БД и в выбранный чат.
- Команды статуса/удаления пользователя с обязательной причиной.

Установка
1) Скопировать `env.example` в `.env` и заполнить:
```
BOT_TOKEN=...
CHANNEL_ID=@fallback_channel   # запасной канал, если нет привязки отдела
DB_URL="file:./dev.db"
META_DB_URL="file:./meta.db"
LINK_TTL_HOURS=24
OWNER_ID=...
ADMIN_LOG_CHAT_ID=...         # можно настроить командой
NODE_ENV=development
```
2) `npm install`
3) Основная БД: `npx prisma db push` (или `prisma migrate` для Postgres)
4) Meta-БД: `npm run prisma:push:meta`
5) (Опционально) сид сотрудников: `npm run seed`

Запуск
- `npm start`

Привязки и админы
- `/bind_department <Отдел>` — выполнить в канале отдела; сохраняется `chat.id` (создать может админ, менять только владелец).
- `/add_admin <id|@username>` — добавить админа (только владелец).
- `/unadd_admin <id|@username>` — убрать админа (только владелец).
- `/set_admin_log_chat` — выполнить в чате для логов (только владелец); лог-чат сохранится в meta-БД.

Статусы и удаление
- `/user_status <id|@username>` — статус пользователя в канале его отдела.
- `/remove_user <id|@username> причина` — бан в канале отдела с логом и уведомлением в чат логов.
- `/check_hist [id|@username]` — последние 10 записей из журнала админов (фильтр по цели).

Структура
- `src/bot.js` — команды и сценарии.
- `prisma/schema.prisma` — основная БД (сотрудники, пользователи, инвайты, аудит).
- `prisma/meta.prisma` — meta-БД (каналы отделов, админы, лог админов, настройки лог-чата).

Под прод
- Перейти на Postgres (`DB_URL`), использовать `prisma migrate`.
- Поднять вебхук вместо long polling.
- Дать боту права админа в каналах отделов.

